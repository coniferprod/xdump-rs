name: Rust

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

env:
  CARGO_TERM_COLOR: always

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
    - name: Build
      run: cargo build --verbose
    - name: Run tests
      run: cargo test --verbose
    - name: Build and upload Rust binary to GitHub Releases
      # You may pin to the exact commit or the version.
      # uses: taiki-e/upload-rust-binary-action@3bbb07bb7f438d0fdf6ce5118bdf9e6e21c0b2a5
      uses: taiki-e/upload-rust-binary-action@v1.22.0
      with:
        # Comma-separated list of binary names (non-extension portion of filename) to build and upload. Note that glob pattern is not supported yet.

      bin: 
        # Archive name (non-extension portion of filename) to be uploaded (variables `$bin`, `$target`, `$tag`, and any string)
      archive: # optional, default is $bin-$target
        # Target name, default is host triple
      target: # optional
        # Comma-separated list of cargo build features to enable
      features: # optional
        # Whether to disable cargo build default features
      no-default-features: # optional
        # Alias for 'no-default-features'
      no_default_features: # optional, default is false
        # Override cargo manifest path
      manifest-path: # optional
        # Alias for 'manifest-path'
      manifest_path: # optional
        # On which platform to distribute the `.tar.gz` file (all, unix, windows, or none)
      tar: # optional, default is unix
        # On which platform to distribute the `.zip` file (all, unix, windows, or none)
      zip: # optional, default is windows
        # Comma-separated list of additional files to be included to archive. Note that glob pattern is not supported yet.
      include: # optional
        # Comma-separated list of additional files to be uploaded separately. Note that glob pattern is not supported yet.
